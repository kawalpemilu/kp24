<div *ngIf="lokasi$ | async as lokasi">

<div class="hierarchy_path">
    @for (p of parents; track p[0]; let last = $last) {
        <a [routerLink]="['/h', p[0]]" routerLinkActive="active"
            class="hierarchy">{{ p[1] }}</a>
        @if (!last) { &gt; }
    }
</div>

@if (lokasi.id.length === 10) {
    <!-- Level TPS -->
    <table class="collapsed_border">
    @for (c of children; track c[0];) {
        <tr>
            <td width="145" align="center">
                <br>
                <b style="font-size: large">TPS #{{ c[1].name }}</b>
                <br>
                <br>
                Pas1: <b>{{ c[1].pas1 }}</b><br>
                Pas2: <b>{{ c[1].pas2 }}</b><br>
                Pas3: <b>{{ c[1].pas3 }}</b><br>
                Sah: <b>{{ c[1].sah }}</b><br>
                ~Sah: <b>{{ c[1].tidakSah }}</b><br>
                <br>
            </td>
            <td width="260" align="center">
                <img [src]="c[1].photoUrl" style="max-width:200px; max-height: 150px"><br>
                <button mat-raised-button color="warn" [routerLink]="['/u', lokasi.id + c[0]]">
                    Upload Photo
                </button>
            </td>
        </tr>
    }
    </table>
} @else {
    <!-- Level Provinsi, Kecamatan, Kelurahan -->
    <table class="collapsed_border">
        <tr bgcolor="lightgrey">
            <th class="lokasi">{{ levelName() }}</th>
            <th class="paslon">Pas1</th>
            <th class="paslon">Pas2</th>
            <th class="paslon">Pas3</th>
            <th class="sah">Sah</th>
            <th class="sah">~Sah</th>
            <th class="cov">COV</th>
        </tr>
        @for (c of children; track c[0];) {
        <tr>
            <td><div class="truncate-text lokasi">
                <a class="hierarchy" [routerLink]="['/h', c[0]]">{{ c[1].name }}</a>
            </div></td>
            @if (c[1].idLokasi && c[1].idLokasi.length > 0) {
                <td>{{ c[1].pas1 }}</td>
                <td>{{ c[1].pas2 }}</td>
                <td>{{ c[1].pas3 }}</td>
                <td class="sah">{{ c[1].sah }}</td>
                <td class="sah">{{ c[1].tidakSah }}</td>
            } @else {
                <td colspan="3">
                    &lt;- Click to upload photo.
                </td>
            }
            <td nowrap align="center">
                {{ 100.0 * (c[1].totalCompletedTps || 0) / c[1].totalTps | number: '1.2-2' }}%<br>
                <span style="font-size: xx-small">
                    {{ (c[1].totalCompletedTps || 0) | number }}/{{ c[1].totalTps | number }}
                </span>
            </td>
        </tr>
        }
        <tr bgcolor="lightgrey">
            <th align="right">TOTAL:</th>
            <th class="paslon">{{ total.pas1 }}</th>
            <th class="paslon">{{ total.pas2 }}</th>
            <th class="paslon">{{ total.pas3 }}</th>
            <th class="sah">{{ total.sah }}</th>
            <th class="sah">{{ total.tidakSah }}</th>
            <th class="cov">
                {{ 100.0 * (total.totalCompletedTps || 0) / total.totalTps | number: '1.2-2' }}%<br>
                <span style="font-size: xx-small">
                    {{ (total.totalCompletedTps || 0) | number }}/{{ total.totalTps | number }}
                </span>
            </th>
        </tr>
    </table>
}
</div>
